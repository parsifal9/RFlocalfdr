---
title: "RFlocalfdr"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{RFlocalfdr}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r, eval=FALSE}
library(RFlocalfdr)

```

A small example using the smoking  data set. 

```{r,  eval=FALSE}
rm(list=ls())
library(sparse.inv.cov)
library(ranger)
data(smoking)
y<-smoking$y
smoking_data<-smoking$rma
y.numeric <-ifelse((y=="never-smoked"),0,1)

rf1 <-ranger(y=y.numeric ,x=smoking_data,importance="impurity",seed=123, num.trees = 10000,classification=TRUE)
t2 <-count_variables(rf1)
imp<-log(rf1$variable.importance)
plot(density((imp)))
```
Detemine a cutoff to get a unimodal density.
```{r , eval=FALSE}
hist(imp[t2 > 2],col=6,lwd=2,breaks=10)
imp <- imp[t2 > 2]
```

After making the cutoff, translate the data
```{r , eval=FALSE}
imp <- imp - min(imp) + .Machine$double.eps 
length(imp)

head(imp)
#     121_at     1431_at   1494_f_at   1598_g_at     1729_at 200000_s_at 
#   2.408754    2.157128    3.919858    3.144564    2.931158    1.174730
```

Fit the model
```{r , eval=FALSE}
ppp<-run.it.importances(imp,debug=0)

aa<-significant.genes(ppp,imp,cutoff=0.2,do.plot=2)
length(aa)
#[1] 189
```
